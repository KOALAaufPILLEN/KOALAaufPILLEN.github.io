:root{
  /* Default (Light Mode) Variables */
  --bg1: #f7f2ff;
  --bg2: #eaf6ff;
  --card: #ffffffd9;
  --card2: #ffffffef;
  --stroke: rgba(17,13,26,.10);
  --shadow: 0 18px 60px rgba(20,10,60,.12);
  --text-main: #1d1334;
  --text-dim: rgba(29, 19, 52, 0.7);

  --cols: 10;
  --rows: 10;
  --cell: 54px;
  --gap: 8px;
  --pad: 14px;
  --boardRadius: 26px;

  --toastMs: 2600ms;

  /* Animations (Default Smooth) */
  --anim-speed: 1s;
}

/* Dark Mode Overrides */
[data-theme="dark"] {
  --bg1: #130924;
  --bg2: #0b0410;
  --card: rgba(30, 20, 50, 0.75);
  --card2: rgba(45, 30, 70, 0.65);
  --stroke: rgba(140, 100, 255, 0.25);
  --shadow: 0 18px 60px rgba(0, 0, 0, 0.55);
  --text-main: #e0d0ff;
  --text-dim: rgba(224, 208, 255, 0.6);
}

*{box-sizing:border-box}
html,body{height:100%}

body{
  margin:0;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
  color: var(--text-main);
  overflow:hidden;
  background: linear-gradient(180deg, var(--bg1), var(--bg2));
  position:relative;
  transition: color 0.3s, background 0.3s;
}

/* Scroll container (scrollbar hidden) */
#page{
  height:100vh;
  overflow:auto;
  position:relative;
  z-index:0;
}
#page{ scrollbar-width:none; }
#page::-webkit-scrollbar{ width:0; height:0; }

/* Scrollender Background Layer */
#scrollBg{
  position:absolute;
  inset:0;
  z-index:0;
  pointer-events:none;
  min-height: 120vh;
  background:
    radial-gradient(circle at 20% 20%, rgba(255,105,180,.14), transparent 48%),
    radial-gradient(circle at 85% 25%, rgba(122,216,255,.20), transparent 52%),
    radial-gradient(circle at 55% 75%, rgba(255,209,90,.16), transparent 50%),
    linear-gradient(120deg,
      rgba(255,79,185,.18),
      rgba(255,209,90,.14),
      rgba(122,216,255,.18),
      rgba(139,92,246,.14),
      rgba(255,79,185,.18)
    );
  background-size: auto, auto, auto, 300% 300%;
  filter: blur(18px);
  opacity:.55;
  animation: bgMove 18s ease-in-out infinite;
  transition: opacity 0.5s;
}
[data-theme="dark"] #scrollBg {
  opacity: 0.25; /* Dimmer background in dark mode */
}

@keyframes bgMove{
  0%{ background-position: 0% 50% }
  50%{ background-position: 100% 50% }
  100%{ background-position: 0% 50% }
}

#globalBg{
  position:absolute;
  inset:0;
  z-index:0;
  pointer-events:none;
  overflow:hidden;
}

/* Background luvvies: langsamer + fade, immer hinter allem */
.bgLuv{
  position:absolute;
  width: clamp(150px, 17vw, 300px);
  filter: drop-shadow(0 18px 40px rgba(0,0,0,.10));
  opacity:.72;
  animation: floaty 18s ease-in-out infinite;
  z-index:0;
  pointer-events:none;
}
[data-theme="dark"] .bgLuv {
  opacity: 0.4;
  filter: drop-shadow(0 18px 40px rgba(0,0,0,.40));
}

.bgLuv img{ width:100%; height:auto; display:block; }
@keyframes floaty{
  0%{ transform: translate(0,0) rotate(-1deg); }
  50%{ transform: translate(10px,-16px) rotate(1.2deg); }
  100%{ transform: translate(0,0) rotate(-1deg); }
}

/* Subtle twinkles (statt bubbles) */
.twinkle{
  position:absolute;
  width: 10px; height: 10px;
  left:0; top:0;
  transform: translate(-50%,-50%) scale(.6);
  opacity:0;
  pointer-events:none;
  mix-blend-mode: screen;
  background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.95), rgba(255,255,255,.15));
  clip-path: polygon(50% 0%, 62% 30%, 100% 50%, 62% 70%, 50% 100%, 38% 70%, 0% 50%, 38% 30%);
  animation: tw 1200ms ease-out forwards;
  filter: drop-shadow(0 0 18px rgba(255,79,185,.18));
}
@keyframes tw{
  0%{opacity:0; transform:translate(-50%,-50%) scale(.45) rotate(0deg)}
  20%{opacity:1}
  100%{opacity:0; transform:translate(-50%,-65%) scale(1.15) rotate(140deg)}
}

/* Header Styles */
.app-header {
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 15px 0;
  margin-bottom: 10px;
  position: relative;
  z-index: 10;
  gap: 20px;
}
.app-header nav {
  display: flex;
  gap: 20px;
  background: var(--card);
  padding: 10px 20px;
  border-radius: 999px;
  border: 1px solid var(--stroke);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  transition: background 0.3s, border 0.3s;
}
.nav-link {
  color: var(--text-main);
  text-decoration: none;
  font-weight: 800;
  font-size: 14px;
  transition: color 0.2s, text-shadow 0.2s;
}
.nav-link:hover {
  text-shadow: 0 0 8px var(--stroke);
}

/* Theme Toggle Button */
#themeToggle {
  background: var(--card);
  border: 1px solid var(--stroke);
  border-radius: 50%;
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  font-size: 20px;
  transition: transform 0.2s, background 0.3s;
  box-shadow: var(--shadow);
}
#themeToggle:hover {
  transform: scale(1.1) rotate(15deg);
}

#app{
  width:min(1100px, 96vw);
  margin: 18px auto 28px;
  position:relative;
  z-index:5; /* Vordergrund */
}

.topRow{
  margin-top: 12px;
  background: var(--card);
  border:1px solid var(--stroke);
  border-radius: 22px;
  padding: 12px;
  box-shadow: var(--shadow);
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  flex-wrap:wrap;
  position:relative;
  z-index:6;
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  transition: background 0.3s, border 0.3s;
}

.diffWrap{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
.diffWrap .label{font-weight:900;opacity:.9;margin-right:4px; color: var(--text-main);}
.diffPills{
  display:flex;
  gap:8px; padding:6px;
  border-radius:999px;
  background: rgba(255,255,255,.5);
  border:1px solid rgba(17,13,26,.08);
}
[data-theme="dark"] .diffPills {
  background: rgba(255,255,255,.15);
}

.diffPills input{display:none}
.diffPills label{
  cursor:pointer;
  user-select:none;
  padding:10px 14px; border-radius:999px;
  font-weight:900; font-size:14px;
  color: var(--text-dim);
  transition: transform .12s ease, background .2s ease, color 0.2s;
}
[data-theme="dark"] .diffPills label {
  color: #d0c0e0;
}

.diffPills input:checked + label{
  background: linear-gradient(135deg, #ff4fb9, #7ad8ff);
  background-size:200% 100%;
  animation: pillGlow 2.2s ease-in-out infinite;
  color:#fff;
  box-shadow: 0 10px 22px rgba(255,79,185,.22);
  transform: translateY(-1px);
}
@keyframes pillGlow{
  0%{ background-position:0% 50% }
  50%{ background-position:100% 50% }
  100%{ background-position:0% 50% }
}

/* Jelly Button */
.Btn{
  position: relative;
  height: 46px;
  padding: 0 16px;
  border-radius: 999px;
  border: none;
  background-color: rgb(151, 95, 255);
  color: white;
  box-shadow: 0px 10px 10px rgb(210, 187, 253) inset,
              0px 5px 10px rgba(5, 5, 5, 0.18),
              0px -10px 10px rgb(124, 54, 255) inset;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap:8px;
  font-weight:1000;
  letter-spacing:.1px;
  transition: transform .12s ease;
  white-space:nowrap;
}
.Btn::before{
  width: 70%; height: 2px; position: absolute;
  background-color: rgba(250, 250, 250, 0.678);
  content: ""; filter: blur(1px);
  top: 7px; border-radius: 50%; left: 15%;
}
.Btn::after{
  width: 70%; height: 2px; position: absolute;
  background-color: rgba(250, 250, 250, 0.137);
  content: ""; filter: blur(1px);
  bottom: 7px; border-radius: 50%; left: 15%;
}
.Btn:hover { animation: jello-horizontal 0.9s both; }
.Btn:active{ transform: scale(.98); }
@keyframes jello-horizontal {
  0% { transform: scale3d(1, 1, 1); }
  30% { transform: scale3d(1.20, 0.80, 1); }
  40% { transform: scale3d(0.80, 1.20, 1); }
  50% { transform: scale3d(1.12, 0.88, 1); }
  65% { transform: scale3d(0.96, 1.04, 1); }
  75% { transform: scale3d(1.04, 0.96, 1); }
  100% { transform: scale3d(1, 1, 1); }
}
.Btn.secondary{
  background: linear-gradient(135deg, #ff4fb9, #ff9adf);
  box-shadow: 0px 10px 10px rgba(255,200,235,.9) inset,
              0px 7px 18px rgba(5, 5, 5, 0.15),
              0px -10px 10px rgba(255,60,180,.55) inset;
}
.Btn.ghost{
  background: rgba(255,255,255,.8);
  color: #2a1849;
  box-shadow: 0px 10px 10px rgba(240,240,255,.9) inset,
              0px 7px 18px rgba(5, 5, 5, 0.10),
              0px -10px 10px rgba(220,220,255,.55) inset;
}
[data-theme="dark"] .Btn.ghost {
  background: rgba(255,255,255,.15);
  color: #e0d0ff;
  box-shadow: 0px 10px 10px rgba(240,240,255,.1) inset,
              0px 7px 18px rgba(5, 5, 5, 0.10),
              0px -10px 10px rgba(220,220,255,.05) inset;
}

.actions{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  align-items:center;
  justify-content:flex-end;
  z-index:6;
}

.stats{
  margin-top: 12px;
  display:grid;
  grid-template-columns: repeat(5, minmax(0, 1fr));
  gap: 10px;
  position:relative;
  z-index:6;
}
.stat{
  background: var(--card2);
  border:1px solid var(--stroke);
  border-radius: 18px;
  padding: 10px 12px;
  box-shadow: 0 10px 30px rgba(20,10,60,.07);
  min-height: 62px;
  display:flex;
  flex-direction:column;
  justify-content:center;
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  transition: background 0.3s, border 0.3s;
}
.stat .k{font-weight:900; font-size:12px; opacity:.7; color: var(--text-main);}
.stat .v{font-weight:1000; font-size:20px; margin-top:2px; color: var(--text-main);}
[data-theme="dark"] .stat .v { color: #fff; }

.progressRow{
  margin-top: 10px;
  background: var(--card2);
  border:1px solid var(--stroke);
  border-radius: 18px;
  padding: 10px 12px;
  box-shadow: 0 10px 30px rgba(20,10,60,.07);
  display:flex;
  align-items:center;
  gap:10px;
  position:relative;
  z-index:6;
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  transition: background 0.3s, border 0.3s;
}
.progressRow b{font-size:14px; color: var(--text-main);}
.bar{
  flex:1;
  height: 14px;
  border-radius:999px;
  background: rgba(140,120,200,.18);
  overflow:hidden;
  border:1px solid rgba(60,20,120,.10);
  position:relative;
}
.bar > i{
  display:block;
  height:100%;
  width:0%;
  border-radius:999px;
  background: linear-gradient(90deg,
    #ff4fb9,
    #ffcf5a,
    #7ad8ff,
    #8b5cf6,
    #ff4fb9
  );
  background-size: 300% 100%;
  animation: barHue 3.2s linear infinite;
  box-shadow: 0 0 18px rgba(255,79,185,.22);
  transition: width .25s ease;
}
@keyframes barHue{
  0%{background-position:0% 50%}
  100%{background-position:100% 50%}
}
.pct{font-weight:1000; min-width:46px; text-align:right; color: var(--text-main);}
[data-theme="dark"] .pct { color: #fff; }

.playArea{
  margin-top: 12px;
  background: var(--card);
  border:1px solid var(--stroke);
  border-radius: 24px;
  box-shadow: var(--shadow);
  padding: 14px;
  position:relative;
  overflow:hidden;
  z-index:6; /* Vordergrund */
  backdrop-filter: blur(14px);
  -webkit-backdrop-filter: blur(14px);
  transition: background 0.3s, border 0.3s;
}

#boardWrap{
  position:relative;
  width:100%;
  min-height: 64vh;
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:10;
  padding: 8px;
  touch-action: none;
}

#board{
  position:relative;
  z-index:12; /* Board immer vorne */
  padding: var(--pad);
  border-radius: var(--boardRadius);
  background:
    radial-gradient(circle at 20% 20%, rgba(255,255,255,.86), rgba(255,255,255,.35)),
    radial-gradient(circle at 80% 70%, rgba(255,209,90,.16), transparent 55%),
    radial-gradient(circle at 30% 75%, rgba(255,79,185,.12), transparent 55%),
    radial-gradient(circle at 75% 25%, rgba(122,216,255,.16), transparent 55%),
    linear-gradient(180deg, rgba(255,255,255,.62), rgba(255,255,255,.36));
  border: 1px solid rgba(17,13,26,.08);
  box-shadow:
    0 18px 70px rgba(20,10,60,.10),
    0 6px 16px rgba(0,0,0,.06) inset;
  overflow:hidden;
  animation: boardFade 20s ease-in-out infinite;
  aspect-ratio: 1/1; /* Modern UI addition */
  transition: background 0.3s, border 0.3s;
}
[data-theme="dark"] #board {
  background:
    radial-gradient(circle at 20% 20%, rgba(255,255,255,.15), rgba(255,255,255,.05)),
    radial-gradient(circle at 80% 70%, rgba(255,209,90,.08), transparent 55%),
    radial-gradient(circle at 30% 75%, rgba(255,79,185,.06), transparent 55%),
    radial-gradient(circle at 75% 25%, rgba(122,216,255,.08), transparent 55%),
    linear-gradient(180deg, rgba(255,255,255,.1), rgba(255,255,255,.05));
  border: 1px solid rgba(255,255,255,.12);
  box-shadow:
    0 18px 70px rgba(0,0,0,.3),
    0 6px 16px rgba(0,0,0,.2) inset;
}

@keyframes boardFade{
  0%{ filter:hue-rotate(0deg) saturate(1) }
  50%{ filter:hue-rotate(10deg) saturate(1.04) }
  100%{ filter:hue-rotate(0deg) saturate(1) }
}

/* Swirl overlay (statt bubble pattern) */
#board:before{
  content:"";
  position:absolute; inset:-20px;
  background:
    conic-gradient(from 180deg at 35% 35%,
      rgba(255,255,255,.18),
      rgba(255,255,255,0) 22%,
      rgba(255,255,255,.12) 45%,
      rgba(255,255,255,0) 65%,
      rgba(255,255,255,.18)
    );
  opacity:.45;
  mix-blend-mode: soft-light;
  filter: blur(0.2px);
  pointer-events:none;
}
[data-theme="dark"] #board:before {
  background:
    conic-gradient(from 180deg at 35% 35%,
      rgba(255,255,255,.08),
      rgba(255,255,255,0) 22%,
      rgba(255,255,255,.05) 45%,
      rgba(255,255,255,0) 65%,
      rgba(255,255,255,.08)
    );
  mix-blend-mode: overlay;
}

#board:after{
  content:"";
  position:absolute; inset:0;
  border-radius: var(--boardRadius);
  box-shadow:
    0 2px 0 rgba(255,255,255,.55) inset,
    0 -6px 12px rgba(0,0,0,.10) inset;
  pointer-events:none;
}
[data-theme="dark"] #board:after {
  box-shadow:
    0 2px 0 rgba(255,255,255,.15) inset,
    0 -6px 12px rgba(0,0,0,.20) inset;
}

#fxLayer{
  pointer-events:none;
  position:absolute;
  inset:0;
  z-index:20;
}

#fsBg{
  position:absolute;
  inset:0;
  z-index:5; /* hinter board */
  pointer-events:none;
  overflow:hidden;
  display:none;
}
body.fs #fsBg{ display:block; }

/* Tiles */
.tile{
  position:absolute;
  width: var(--cell);
  height: var(--cell);
  left:0; top:0;
  transform: translate(var(--x), var(--y));
  transition: transform 190ms cubic-bezier(.2,.9,.2,1.0);
  will-change: transform;
  z-index:15;
}
.tile.bigMellow{
  width: calc(var(--cell) * 2 + var(--gap));
  height: calc(var(--cell) * 2 + var(--gap));
  z-index:25;
}
.tile.dragging{ transition:none !important; z-index: 50; filter: drop-shadow(0 22px 20px rgba(0,0,0,.20)); }
.tile.locked{ pointer-events:none; }

.plate{
  width:100%; height:100%;
  border-radius: 16px;
  background:
    radial-gradient(circle at 22% 18%, rgba(255,255,255,.88), rgba(255,255,255,0) 40%),
    linear-gradient(135deg, var(--p1), var(--p2));
  border: 1px solid rgba(255,255,255,.50);
  box-shadow:
    0 14px 24px rgba(20,10,60,.10),
    0 4px 8px rgba(0,0,0,.06),
    0 -10px 18px rgba(255,255,255,.45) inset;
  position:relative;
  overflow:hidden;

  transform: translateY(var(--oy, 0px)) scale(1);
  opacity: var(--op, 1);
  transition: transform 260ms cubic-bezier(.2,.9,.2,1), opacity 260ms ease;
}
.tile.bigMellow .plate{ border-radius: 26px; }

/* Swirl on tile (subtle) */
.plate:before{
  content:"";
  position:absolute; inset:-18px;
  background:
    conic-gradient(from 120deg at 35% 35%,
      rgba(255,255,255,.18),
      rgba(255,255,255,0) 26%,
      rgba(255,255,255,.12) 54%,
      rgba(255,255,255,0) 72%,
      rgba(255,255,255,.18)
    );
  opacity:.35;
  mix-blend-mode: soft-light;
  pointer-events:none;
}
.plate:after{
  content:"";
  position:absolute; inset:0;
  border-radius:inherit;
  box-shadow:
    0 2px 0 rgba(255,255,255,.55) inset,
    0 -6px 12px rgba(0,0,0,.10) inset;
  pointer-events:none;
}

/* Luvvies auf der Karte größer */
.tile img{
  position:absolute;
  inset: 6%;
  width:88%;
  height:88%;
  object-fit:contain;
  filter: drop-shadow(0 10px 12px rgba(0,0,0,.10));
  user-select:none;
  -webkit-user-drag:none;
  pointer-events:none;
}
.tile.bigMellow img{
  inset: 8%;
  width:84%;
  height:84%;
}

/* Question mark powerup visual */
.qmark{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:1000;
  font-size: 26px;
  color:#fff;
  text-shadow: 0 10px 18px rgba(0,0,0,.22);
  pointer-events:none;
}

/* Animierter Power Background (für Powerups + ??? + Lovelie) */
.powerAnim .plate{
  background: linear-gradient(135deg, #ff4fb9, #ffcf5a, #7ad8ff, #8b5cf6, #ff4fb9) !important;
  background-size: 320% 100% !important;
  animation: mystHue 3.8s ease-in-out infinite;
}
@keyframes mystHue{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}

/* Puff reveal (??? -> random) */
.tile.puff .plate{ animation: puff 520ms ease both; }
@keyframes puff{
  0%{ transform: translateY(0) scale(1); filter: blur(0px); }
  40%{ transform: translateY(-2px) scale(1.12); filter: blur(0.2px); }
  100%{ transform: translateY(0) scale(1); filter: blur(0px); }
}

/* Pop */
.pop .plate{ animation: popPlate 420ms ease-in both; }
@keyframes popPlate{
  0%{ transform: translateY(0) scale(1); opacity:1; }
  55%{ transform: translateY(-2px) scale(1.14); opacity:1; }
  100%{ transform: translateY(8px) scale(.30); opacity:0; }
}

/* Landing bounce */
.land .plate{ animation: landPlate 560ms cubic-bezier(.2,.9,.2,1) both; }
@keyframes landPlate{
  0%{ transform: translateY(0) scale(1); }
  28%{ transform: translateY(4px) scale(1.06, .98); }
  58%{ transform: translateY(-4px) scale(.99,1.04); }
  100%{ transform: translateY(0) scale(1); }
}

/* Spawn glow (Enhanced) */
.spawnGlow .plate{ animation: spawnGlow 800ms ease-out both; }
@keyframes spawnGlow{
  0%{ filter: drop-shadow(0 0 0 rgba(255,255,255,0)); transform: translateY(20px) scale(.5); opacity: 0; }
  50%{ filter: drop-shadow(0 0 25px rgba(255,255,255,0.8)); transform: translateY(-5px) scale(1.1); opacity: 1; }
  100%{ filter: drop-shadow(0 0 0 rgba(255,255,255,0)); transform: translateY(0) scale(1); opacity: 1; }
}

/* Hint auffälliger */
.tile.hint .plate{
  outline: 3px solid rgba(255,79,185,.85);
  box-shadow:
    0 0 0 5px rgba(122,216,255,.35),
    0 0 30px rgba(255,79,185,.28),
    0 18px 40px rgba(0,0,0,.12);
  animation: hintGlow 1.0s ease-in-out infinite;
}
@keyframes hintGlow{
  0%,100%{ filter: saturate(1) brightness(1); }
  50%{ filter: saturate(1.25) brightness(1.12); }
}

/* Mellow HP Zahl: kein Background, größer, fade */
.hp{
  position:absolute;
  right:10px; top:8px;
  font-weight:1000;
  font-size: 18px;
  color: rgba(255,255,255,.98);
  text-shadow:
    0 10px 20px rgba(0,0,0,.18),
    0 2px 0 rgba(0,0,0,.12);
  z-index:30;
  background:none;
  border:none;
  box-shadow:none;
  padding:0;
  animation: hpFade 2.2s ease-in-out infinite;
  pointer-events:none;
}
.tile.bigMellow .hp{
  font-size: 22px;
  right:14px;
  top:12px;
}
@keyframes hpFade{
  0%,100%{ opacity:.60; transform: translateY(0); }
  50%{ opacity:1; transform: translateY(-1px); }
}

/* Below panels */
.below{
  margin-top: 12px;
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
  align-items:stretch;
  position:relative;
  z-index:6;
}
.below > .panel{height:100%}

@media (max-width: 880px){
  .stats{grid-template-columns: repeat(2, minmax(0,1fr));}
  .below{grid-template-columns:1fr;}
  #boardWrap{min-height: 52vh;}
}

.panel{
  background: var(--card2);
  border:1px solid var(--stroke);
  border-radius: 22px;
  padding: 12px;
  box-shadow: var(--shadow);
  position:relative;
  z-index:6;
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  transition: background 0.3s, border 0.3s;
}
.panel h3{margin:0 0 10px;font-size:16px; color: var(--text-main);}
[data-theme="dark"] .panel h3 { color: #fff; }

.luvGrid{display:grid;grid-template-columns: repeat(2, minmax(0,1fr));gap:10px}
.luvCard{
  display:flex;gap:10px;align-items:center;
  padding:10px;border-radius:18px;
  background: rgba(255,255,255,.82);
  border:1px solid rgba(17,13,26,.08);
  box-shadow: 0 12px 26px rgba(20,10,60,.08);
  cursor:pointer;transition: transform .12s ease;
  color: var(--text-main);
}
[data-theme="dark"] .luvCard {
  background: rgba(255,255,255,.15);
  color: #fff;
}

.luvCard:hover{ transform: translateY(-1px); }
.luvCard img{
  width: 78px;height: 78px;object-fit:contain;
  filter: drop-shadow(0 10px 12px rgba(0,0,0,.12));
  flex:0 0 auto;
}
.luvCard b{display:block}
.luvCard small{opacity:.7;font-weight:900}

#rightPanel{
  display:flex;
  flex-direction:column;
  gap:10px;
  min-height: 100%;
}

.lbRow{display:flex; gap:8px; flex-wrap:wrap; align-items:center;}
.lbRow input{
  flex:1; min-width: 170px; height:44px;
  border-radius:14px; border:1px solid rgba(17,13,26,.12);
  padding:0 12px; font-weight:900; outline:none;
  background: rgba(255,255,255,.92);
}

/* Leaderboard scrollbar: aktiv, aber optisch clean */
.lbList{
  display:flex;
  flex-direction:column; gap:8px;
  overflow:auto;
  padding-right:6px;
  flex:1;
  min-height: 260px;
  border-radius: 16px;
  scrollbar-width: thin;
}
.lbList::-webkit-scrollbar{ width: 10px; }
.lbList::-webkit-scrollbar-thumb{
  background: rgba(151,95,255,.35);
  border-radius: 999px;
  border: 3px solid rgba(255,255,255,.6);
}
.lbList::-webkit-scrollbar-track{
  background: rgba(255,255,255,.35);
  border-radius: 999px;
}
[data-theme="dark"] .lbList::-webkit-scrollbar-track {
  background: rgba(255,255,255,.1);
}

.lbItem{
  display:flex; justify-content:space-between; align-items:center; gap:10px;
  background: rgba(255,255,255,.82);
  border:1px solid rgba(17,13,26,.08);
  border-radius:16px;
  padding:10px 10px;
  box-shadow: 0 10px 24px rgba(20,10,60,.07);
}
.lbItem .left b{display:block}
.lbItem .left small{opacity:.7;font-weight:900}
.lbItem .score{font-weight:1000}

/* Ranks */
.lbItem.rank1{
  background:linear-gradient(90deg, rgba(255,215,0,.28), rgba(255,255,255,.14));
  box-shadow:0 0 18px rgba(255,215,0,.65);
  animation:shine 1.9s linear infinite, glowGold 2s ease-in-out infinite alternate;
  border: 1px solid rgba(255, 215, 0, 0.5);
}
.lbItem.rank2{
  background:linear-gradient(90deg, rgba(192,192,192,.25), rgba(255,255,255,.12));
  box-shadow:0 0 14px rgba(220,220,220,.55);
  animation:pulse 1.6s ease-in-out infinite, glowSilver 2s ease-in-out infinite alternate;
  border: 1px solid rgba(192, 192, 192, 0.5);
}
.lbItem.rank3{
  background:linear-gradient(90deg, rgba(205,127,50,.25), rgba(255,255,255,.10));
  box-shadow:0 0 12px rgba(205,127,50,.55);
  animation:bounceMedal 1.6s ease-in-out infinite, glowBronze 2s ease-in-out infinite alternate;
  border: 1px solid rgba(205, 127, 50, 0.5);
}

@keyframes glowGold {
  from { box-shadow: 0 0 10px rgba(255, 215, 0, 0.4); }
  to { box-shadow: 0 0 25px rgba(255, 215, 0, 0.8); }
}
@keyframes glowSilver {
  from { box-shadow: 0 0 8px rgba(192, 192, 192, 0.4); }
  to { box-shadow: 0 0 20px rgba(192, 192, 192, 0.7); }
}
@keyframes glowBronze {
  from { box-shadow: 0 0 6px rgba(205, 127, 50, 0.4); }
  to { box-shadow: 0 0 15px rgba(205, 127, 50, 0.7); }
}

@keyframes shine{
  0%{filter:brightness(1)}
  50%{filter:brightness(1.25)}
  100%{filter:brightness(1)}
}
@keyframes pulse{
  0%,100%{transform:scale(1)}
  50%{transform:scale(1.03)}
}
@keyframes bounceMedal{
  0%,100%{transform:translateY(0)}
  50%{transform:translateY(-2px)}
}

/* Footer Styles */
.app-footer {
  display: flex;
  justify-content: center;
  gap: 20px;
  padding: 20px 0 30px;
  position: relative;
  z-index: 10;
}
.foot-link {
  color: var(--text-dim);
  text-decoration: none;
  font-size: 12px;
  font-weight: 700;
  transition: color 0.2s;
}
.foot-link:hover {
  color: var(--text-main);
}
[data-theme="dark"] .foot-link {
  color: rgba(224, 208, 255, 0.5);
}
[data-theme="dark"] .foot-link:hover {
  color: rgba(224, 208, 255, 0.9);
}

/* Toasts -> rechts seitlich (Desktop/Fullscreen), Mobile oben */
#toast{
  position: fixed;
  right: 16px;
  top: 110px;
  z-index: 9999;
  pointer-events:none;
  display:flex;
  flex-direction:column;
  gap:10px;
  align-items:flex-end;
  max-width: min(420px, 92vw);
}
@media (max-width: 560px){
  #toast{
    left: 50%;
    right: auto;
    top: 10%;
    transform: translateX(-50%);
    align-items:center;
  }
}
.toast{
  width: 100%;
  background: rgba(255,255,255,.92);
  border:1px solid rgba(17,13,26,.12);
  border-radius: 20px;
  padding: 12px 14px;
  box-shadow: 0 18px 60px rgba(0,0,0,.15);
  font-weight:1000;
  text-align:left;
  animation: toastIn var(--toastMs) ease forwards;
}
.toast small{display:block;font-weight:900;opacity:.75;margin-top:3px}
@keyframes toastIn{
  0%{opacity:0; transform: translateY(-10px) scale(.96)}
  16%{opacity:1; transform: translateY(0) scale(1)}
  86%{opacity:1}
  100%{opacity:0; transform: translateY(-10px) scale(.98)}
}

/* Modal */
.modalBack{
  position:fixed;
  inset:0;
  display:none;
  align-items:center; justify-content:center;
  background: rgba(10,8,18,.55);
  z-index: 99998;
  padding: 18px;
}
.modal{
  width: min(760px, 96vw);
  max-height: min(82vh, 780px);
  overflow:auto;
  background: rgba(255,255,255,.96);
  border-radius: 24px;
  border:1px solid rgba(17,13,26,.12);
  box-shadow: 0 28px 90px rgba(0,0,0,.25);
  padding: 14px 14px 12px;
}
.modal h2{margin:6px 0 8px}
.modal p, .modal li{font-weight:800; opacity:.9}
.modal .foot{
  display:flex; gap:10px; justify-content:flex-end; flex-wrap:wrap;
  margin-top:12px;
}
.tiny{font-size:12px; opacity:.8; font-weight:900}

/* Greeting */
.greet{
  text-align:center;
  padding: 18px 14px 14px;
}
.greet img{
  width:min(380px, 82vw);
  height:auto;
  filter: drop-shadow(0 18px 28px rgba(0,0,0,.14));
  margin: 4px auto 10px;
  display:block;
}
.greet h2{ margin: 6px 0 8px; }
.greet .sub{
  font-weight:900;
  opacity:.8;
  margin: 0 auto 10px;
  max-width: 560px;
}
.greet .cta{
  display:flex;
  justify-content:center;
  gap:10px;
  flex-wrap:wrap;
  margin-top: 12px;
}

/* FX star */
.star{
  position:absolute;
  left:0; top:0;
  width: 12px; height: 12px;
  transform: translate(-50%,-50%) scale(.6);
  opacity:0;
  pointer-events:none;
  mix-blend-mode: screen;
  background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.95), rgba(255,255,255,.2));
  clip-path: polygon(50% 0%, 62% 30%, 100% 50%, 62% 70%, 50% 100%, 38% 70%, 0% 50%, 38% 30%);
  animation: starPop 820ms ease forwards;
  filter: drop-shadow(0 0 18px rgba(255,79,185,.22));
}
@keyframes starPop{
  0%{opacity:0; transform:translate(-50%,-50%) scale(.4) rotate(0deg)}
  20%{opacity:1; transform:translate(-50%,-50%) scale(1) rotate(20deg)}
  100%{opacity:0; transform:translate(-50%,-75%) scale(.9) rotate(160deg)}
}

.ring{
  position:absolute; left:0; top:0;
  width: 10px; height: 10px;
  border-radius:999px;
  border: 3px solid rgba(255,255,255,.95);
  box-shadow: 0 0 30px rgba(255,79,185,.28);
  transform: translate(-50%,-50%) scale(.4);
  opacity:0;
  animation: ring 720ms ease-out forwards;
  pointer-events:none;
  mix-blend-mode: screen;
}
@keyframes ring{
  0%{opacity:0; transform:translate(-50%,-50%) scale(.35)}
  15%{opacity:1}
  100%{opacity:0; transform:translate(-50%,-50%) scale(4.2)}
}

/* Fullscreen */
body.fs{ overflow:hidden; }
body.fs #app{ width: min(1200px, 98vw); margin: 10px auto; }
body.fs #boardWrap{
  min-height: 92vh;
  padding-top: 84px;
  padding-bottom: 12px;
}

/* FS HUD: left / center / right */
#fsHud{
  position:absolute;
  left: 14px;
  right: 14px;
  top: 12px;
  z-index: 60;
  display:none;
  align-items:flex-start;
  justify-content:space-between;
  gap:10px;
  pointer-events:none;
  flex-wrap:wrap;
}
body.fs #fsHud{display:flex}

.hudLeft, .hudCenter, .hudRight{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
.hudCenter{
  justify-content:center;
  flex: 1;
  min-width: 240px;
}

.hudChip{
  padding:8px 10px;
  border-radius: 999px;
  background: rgba(255,255,255,.88);
  border:1px solid rgba(17,13,26,.12);
  box-shadow: 0 16px 40px rgba(0,0,0,.12);
  font-weight:1000;
  font-size: 13px;
  white-space:nowrap;
  pointer-events:none;
  animation: chipFade 3.2s ease-in-out infinite;
}
@keyframes chipFade{
  0%,100%{ opacity:.92; }
  50%{ opacity:1; }
}
.hudChip.color{
  background: linear-gradient(135deg, rgba(255,79,185,.88), rgba(122,216,255,.86));
  color:#fff;
  border:1px solid rgba(255,255,255,.35);
  background-size: 200% 200%;
  animation: hudGlow 3.2s ease-in-out infinite;
  opacity:1;
}
@keyframes hudGlow{
  0%{ background-position: 0% 50%; }
  50%{ background-position: 100% 50%; }
  100%{ background-position: 0% 50%; }
}

.hudProg{
  pointer-events:none;
  display:flex;
  align-items:center;
  gap:8px;
  padding:8px 10px;
  border-radius: 999px;
  background: rgba(255,255,255,.88);
  border:1px solid rgba(17,13,26,.12);
  box-shadow: 0 16px 40px rgba(0,0,0,.12);
  min-width: min(520px, 70vw);
  justify-content:center;
}
.hudProg .pbar{
  flex:1;
  height: 12px;
  border-radius:999px;
  overflow:hidden;
  background: rgba(140,120,200,.18);
  border:1px solid rgba(60,20,120,.10);
  min-width: 160px;
}
.hudProg .pbar i{
  display:block;height:100%;width:0%;
  border-radius:999px;
  background: linear-gradient(90deg,#ff4fb9,#ffcf5a,#7ad8ff,#8b5cf6,#ff4fb9);
  background-size: 300% 100%;
  animation: barHue 3.2s linear infinite;
  transition: width .25s ease;
  box-shadow:0 0 18px rgba(255,79,185,.22);
}

.hudBtn{
  pointer-events:auto;
  height: 40px;
  padding: 0 12px;
  border-radius: 999px;
  border: 1px solid rgba(17,13,26,.12);
  background: rgba(255,255,255,.85);
  box-shadow: 0 14px 34px rgba(0,0,0,.12);
  font-weight:1000;
  cursor:pointer;
  animation: chipFade 3.2s ease-in-out infinite;
}
.hudBtn:hover{ animation: jello-horizontal .9s both; }

/* Colored fullscreen buttons */
.hudBtn.exit{
  background: linear-gradient(135deg, rgba(255,70,70,.92), rgba(255,130,130,.86));
  color:#fff;
  border: 1px solid rgba(255,255,255,.28);
}
.hudBtn.guide{
  background: linear-gradient(135deg, rgba(90,170,255,.92), rgba(140,220,255,.86));
  color:#fff;
  border: 1px solid rgba(255,255,255,.28);
}
.hudBtn.hint{
  background: linear-gradient(135deg, rgba(255,79,185,.92), rgba(255,170,230,.86));
  color:#fff;
  border: 1px solid rgba(255,255,255,.28);
}

/* Mobile/Tablet fullscreen layout */
@media (max-width: 820px){
  body.fs #boardWrap{ padding-top: 14px; padding-bottom: 102px; min-height: 92vh; }
  #fsHud{
    top:auto;
    bottom: 10px;
    align-items:flex-end;
  }
  .hudProg{ min-width: min(520px, 92vw); }
  .hudBtn{ height:44px; padding:0 14px; }
}
@media (orientation: portrait) and (min-width: 600px){
  body.fs #boardWrap{ padding-top: 16px; padding-bottom: 110px; }
  .hudProg{ min-width: min(560px, 92vw); }
}
